document.domain="58.com";var ppudomian="//ppuswapapi.58.com",webimapp=null,APP_ID="10023-wb@jN1oMaGj8lk0",USER_SOURCE="2",USER_ID="",IM_TOKEN="",ENVS=window.ENVS?window.ENVS:"online",LOGIN_URL="//passport.58.com/login?path=",default_avatar="https://pic1.58cdn.com.cn/p1/n_v1bkuymc2tsxlfo5wrgb7a.png",ICS_INFO={user_id:"49337748964375",user_source:"2",avatar:"//pic3.58cdn.com.cn/nowater/webim/big/n_v2408f88bec7c24283ab5a3ac208964ad0.png",getUrl:function(){var e=location.search||"";return e.match(/scene_id=([^&]+)/),e.match(/from=([^&]+)/),e=(e.match(/joinfrom=([^&]+)/)||{})[1]||"imweb",e=decodeURIComponent(e)===e?encodeURIComponent(e):e,"//ai.58.com/pc/#/entry/joinfrom="+e}},ZNX_INFO={user_id:"60687145693708",user_source:"2",avatar:"//pic3.58cdn.com.cn/nowater/webim/big/n_v214df5a063c8648ca8307f16ad55c82c0.png"};"integrate"===ENVS&&(ZNX_INFO.user_id="59911917385233"),window.isAnonymous=function(){return!window.USER_ID},function(e){var t=e.Base64,i=function(e){for(var t={},i=0,n=e.length;i<n;i++)t[e.charAt(i)]=i;return t}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),n=String.fromCharCode,o=function(e){if(2>e.length){var t=e.charCodeAt(0);return 128>t?e:2048>t?n(192|t>>>6)+n(128|63&t):n(224|t>>>12&15)+n(128|t>>>6&63)+n(128|63&t)}return t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320),n(240|t>>>18&7)+n(128|t>>>12&63)+n(128|t>>>6&63)+n(128|63&t)},r=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,s=function(e){return e.replace(r,o)},a=function(e){var t=[0,2,1][e.length%3];return e=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0),["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>12&63),2<=t?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6&63),1<=t?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&e)].join("")},c=e.btoa?function(t){return e.btoa(t)}:function(e){return e.replace(/[\s\S]{1,3}/g,a)},u=function(e,t){return t?c(s(String(e))).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):c(s(String(e)))},p=/[\u00c0-\u00df][\u0080-\u00bf]|[\u00e0-\u00ef][\u0080-\u00bf]{2}|[\u00f0-\u00f7][\u0080-\u00bf]{3}/g,d=function(e){switch(e.length){case 4:return e=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536,n(55296+(e>>>10))+n(56320+(1023&e));case 3:return n((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return n((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},l=function(e){return e.replace(p,d)},f=function(e){var t=e.length,o=t%4;return e=(0<t?i[e.charAt(0)]<<18:0)|(1<t?i[e.charAt(1)]<<12:0)|(2<t?i[e.charAt(2)]<<6:0)|(3<t?i[e.charAt(3)]:0),e=[n(e>>>16),n(e>>>8&255),n(255&e)],e.length-=[0,0,2,1][o],e.join("")},_=e.atob?function(t){return e.atob(t)}:function(e){return e.replace(/[\s\S]{1,4}/g,f)},m=function(e){return l(_(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")))};if(e.Base64={VERSION:"2.1.9",atob:_,btoa:c,fromBase64:m,toBase64:u,utob:s,encode:u,encodeURI:function(e){return u(e,!0)},btou:l,decode:m,noConflict:function(){var i=e.Base64;return e.Base64=t,i}},"function"===typeof Object.defineProperty){var h=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};e.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",h((function(){return m(this)}))),Object.defineProperty(String.prototype,"toBase64",h((function(e){return u(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",h((function(){return u(this,!0)})))}}}(this),function(e){var t=e.$,i=null,n=null,o=function(e){return"null"===e+""||"undefined"===e+""||""===e},r=function(e){var t=null;return document.cookie&&(e=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)")),null!=e&&(t=decodeURIComponent(e[2]))),t},s=function(){var e=r("PPU");if(!e)return"";var t="";e=e.match(/(^|")UID=([^&]*)(&|$)/);return null!=e&&(t=decodeURIComponent(e[2])),t},a=function(i,n){if(!r("PPU"))return n&&n();var o=[];o.push("appId="+e.APP_ID),o.push("source="+e.USER_SOURCE),o.push("clientType=pcweb"),t.ajax({url:ppudomian+"/swap/im?"+o.join("&"),type:"get",dataType:"jsonp",beforeSend:function(t,i){if(t=i.url.split(ppudomian)[1],null==t||0==t.length)t="";else{t=e.Base64.encode(t);var n=0,o=t.indexOf("=");-1!==o&&(n=t.length-o,t=t.substring(0,o)),t=(t+n).split("").reverse().join("")}i.url=i.url+"&key="+t},success:function(e){e.userId&&e.token?i&&i(e.userId,e.token):n&&n()},error:function(e,t,i){n&&n()}})},c=function(e,i){if(o(e))return i(null);t.ajax({url:"//api.58.com/iminfo",type:"get",dataType:"jsonp",data:{infoid:e},success:function(e){0==e.code?i(e.data):i(null)},fail:function(e){i(null)}})},u=function(t,i,n,r,s){c(n,(function(n){if(!o(n)){var a,c,u="";n.invitation&&n.invitation.detailaction&&n.invitation.detailaction.content&&(a=n.invitation.detailaction.content.local_name,c=n.invitation.detailaction.content.list_name),a="//"+a+".58.com/"+c+"/"+n.infoid+"x.shtml",c="rb"==l("p")?"RIGHT_BOTTOM":"CENTER",o(n)||(n.infoimg=o(n.infoimg)?null:n.infoimg,n.title=o(n.title)?"":n.title,n.invitation=o(n.invitation)?{}:n.invitation,n.invitation.pricenum=o(n.invitation.pricenum)?"":n.invitation.pricenum,n.invitation.priceunit=o(n.invitation.priceunit)?"":n.invitation.priceunit,o(n.infoimg)?"CENTER"==c?(u=u+'<div style="width:100%;height:100%;cursor:pointer;" onclick="javascript:window.parent.open(\''+a+'\', \'_blank\');"><span style="width:679px;height:12px;top:16px;display:inline-block;position:absolute;left:24px;font-size:12px;"><span style="width:80%;height:12px;display:inline-block;position:relative;text-overflow: ellipsis; overflow: hidden;white-space: nowrap;">'+n.title+"</span>",u+='<span  style="width:20%;height:12px;display:inline-block;position:absolute;right:0;text-align:right">',u+='<text style="color:red;font-size:12px;">'+n.invitation.pricenum+n.invitation.priceunit+"</text></span></span></div>"):(u=u+'<div style="width:100%;height:100%;cursor:pointer;" onclick="javascript:window.parent.open(\''+a+'\', \'_blank\');"><span style="width:420px;height:12px;top:16px;display:inline-block;position:absolute;left:24px;font-size:12px;"><span style="width:80%;height:12px;display:inline-block;position:relative;text-overflow: ellipsis; overflow: hidden;white-space: nowrap;">'+n.title+"</span>",u+='<span  style="width:20%;height:12px;display:inline-block;position:absolute;right:0;text-align:right">',u+='<text style="color:red;font-size:12px;">'+n.invitation.pricenum+"&nbsp;&nbsp;"+n.invitation.priceunit+"</text></span></span></div>"):"CENTER"==c?(u=u+'<div style="width:100%;height:100%;cursor:pointer;" onclick="javascript:window.parent.open(\''+a+"', '_blank');\"><img src=\""+(n.infoimg?n.infoimg:"//pic3.58cdn.com.cn/nowater/webim/big/n_v1bl2lwxtpeksfrr3aea3q.png"),u+='" alt=""  style="width:48px;height:36px;top:12px;left:24px;position:absolute;" />',u+='<span style="width:623px;height:32px;top:14px;display:inline-block;position:absolute;left:80px;font-size:12px;"><span style="width:100%;height:12px;display:inline-block;position:relative;padding-bottom:8px;text-overflow: ellipsis; overflow: hidden;white-space: nowrap;">',u+=n.title+"</span>",u+='<span  style="height:12px;display:inline-block;">',u+='<text style="color:red;font-size:12px;">'+n.invitation.pricenum+n.invitation.priceunit+"</text></span></span></div>"):(u=u+'<div style="width:100%;height:100%;cursor:pointer;" onclick="javascript:window.parent.open(\''+a+"', '_blank');\"><img src=\""+(n.infoimg?n.infoimg:"//pic3.58cdn.com.cn/nowater/webim/big/n_v1bl2lwxtpeksfrr3aea3q.png"),u+='" alt=""  style="width:48px;height:36px;top:12px;left:24px;position:absolute;" />',u+='<span style="width:364px;height:32px;top:14px;display:inline-block;position:absolute;left:80px;font-size:12px;"><span style="width:80%;height:12px;display:inline-block;position:relative;padding-bottom:8px;text-overflow: ellipsis; overflow: hidden;white-space: nowrap;">',u+=n.title+"</span>",u+='<span  style="width:20%;height:12px;display:inline-block;position:absolute;right:0;padding-bottom:8px;text-align:right;">',u+='<text style="color:red;font-size:12px;">'+n.invitation.pricenum+"&nbsp;&nbsp;"+n.invitation.priceunit+"</text></span></span></div>")),e.webimapp.setTopic(t,i,u,r,s)}}))},p=function(e){var t=i.getRefer(e.to_id,e.to_source);return t&&t.invitation&&(e.refer=t,t=t.invitation,e.refer.invitation.role=t.role&&"2"===t.role.toString()?"1":t.role&&"1"===t.role.toString()?"2":""),e},d=function(){var t=e.location.href.indexOf("?");return 0<t?e.location.href.substr(0,t):e.location.href},l=function(t){return t=new RegExp(t+"=([^&?]*)","ig"),(t=e.location.search.substr(1).match(t))&&0!==t.length?t[0].split("=")[1]:null},f=function(){(function(){if(e.USER_ID){var r,s=l("opts");if(s)try{r=JSON.parse(decodeURIComponent(s))}catch(f){}e.chatTo=function(t){e.webimconfig&&e.webimconfig.onWChatWinNormal&&e.webimconfig.onWChatWinNormal(),webimapp.normalize(),t.scene=t.scene?t.scene:"listing",t.cityid=t.cityid?t.cityid:"",t.flow_source=t.flow_source?t.flow_source:"",t.cate_extra=t.cate_extra?t.cate_extra:"",t.transfer_info=t.transfer_info?t.transfer_info:"",t.usersource=o(t.usersource)?e.USER_SOURCE:t.usersource,t.ecom_info=t.ecom_info?t.ecom_info:{};var i={invitation:{id:t.postid,rootcateid:t.rootcateid,cateid:t.cateid,scene:t.scene,cityid:t.cityid,flow_source:t.flow_source,cate_extra:t.cate_extra,transfer_info:t.transfer_info,role:"1",refer_time:(new Date).getTime()},ecom_info:t.ecom_info};!1===t.autoSendMsg?e.webimapp.triggerEvent("sendMsg",{user_id:t.userid,user_source:t.usersource,post_id:t.postid},(function(){e.webimapp.chatTo(t.userid,t.usersource,(function(){e.webimapp._gotoContact({user_id:t.userid,user_source:t.usersource}),e.webimbiz.setRefer(t.userid,t.usersource,i)}))})):t.shop_id&&t.shop_source?e.webimapp.chatTo(t.userid,t.usersource,(function(){e.webimapp._gotoContact({user_id:t.userid,user_source:t.usersource}),e.webimbiz.setRefer(t.userid,t.usersource,i)}),t.shop_id,t.shop_source):e.webimapp.chatTo(t.userid,t.usersource,(function(){e.webimapp._gotoContact({user_id:t.userid,user_source:t.usersource}),e.webimbiz.setRefer(t.userid,t.usersource,i)}))};s={user_id:e.USER_ID,source:e.USER_SOURCE,im_token:e.IM_TOKEN,device_id:"",appid:e.APP_ID,client_type:"pcweb",comet:e.COMET,ws:e.WS,api:e.API,envs:ENVS,uploadimg:"https://upload.58cdn.com.cn/json",stat_dev_info:!0,getNewToken:function(e){a((function(t,i){e&&e(i)}),(function(){}))},is_shop_mode:!0,supported_functions:{is_support_provide_contactinfo:!1,is_support_forward:!1,is_show_audio_video:!!r&&r.isShowAudioVideo}};var c=!0;i=new e.WebIMSDK(s),n=new e.ShopWebIMSDK(s),i.addEventListener("login",(function(){t("#status .isImLogined").text("im登录了。").css("color","green")})),i.addEventListener("logout",(function(e){t("#status .isImLogined").text("im登录退出。"+e).css("color","red")})),i.addEventListener("connectchange",(function(e,n){e?(t("#status .isCometConnected").text("长连接正常。").css("color","green"),c||i.reloadSessions({},(function(e,t){for(var n in i.resetLoadedMsg(),i.resetLoadedUser(),i.resetLoadedGroupInfo(),webimapp._children)"ChatWindow"==webimapp._children[n]._options.component_type&&(webimapp._children[n].unactive(),webimapp._children[n].destroy(),delete webimapp._children[n]);e=webimapp._currentcontact,webimapp._currentcontact=null,e&&(e.is_reload_session=!0,webimapp._gotoContact(e))})),c=!1):t("#status .isCometConnected").text("长连接断开。"+n.error_msg).css("color","red")})),i.addEventListener("userChanged",(function(){e.location.href=e.location.href})),i.addEventListener("referChanged",(function(e){var t=e.refer;t&&t.invitation&&u(e.user_id,e.user_source,t.invitation.id,e.shop_id,e.shop_source)})),e.webimbiz=i,e.webimapp=new e.WebIMApp({biz:i,shop_biz:n,config:{is_show_audio_video:!!s.supported_functions&&s.supported_functions.isShowAudioVideo,is_support_forward:!!s.supported_functions&&s.supported_functions.is_support_forward,maxUrl:d(),stat:{appversion:"1.0",appid:"20021",appkey:"wb@wB8T3DqHlmA",cookiename:"webimwmda",pn:"default",reportIntervalTime:15,reportIntervalCount:1},"msg-shortcut":["能见面交易？","亲，包邮吗？","价格还可以商量？","你好，这个职位还在招人吗？","你好，这套房源租出去了吗？"],"msg-show-converter":function(e){return e},"msg-send-converter":p,"bind-cellphone":function(t,i){(e.parent!=e.self?e.parent.CL:e.CL).invoke("popuplogin",{source:"webim",callback:function(){t&&t()},closeCallback:function(){i&&i()},isCheckSecretMobile:!0})},"xz-source":"1","sessions-converter":function(e,t){if(0===e.length)return t(e);var n,o={user_id:ICS_INFO.user_id,user_source:ICS_INFO.user_source},r=[o];if(e.forEach((function(e,t){e.user.user_id+"@"+e.user.user_source==ZNX_INFO.user_id+"@"+ZNX_INFO.user_source&&(n=!0)})),n){var s=ZNX_INFO;r.push(s)}var a=r.map((function(e){return e.user_id+"@"+e.user_source})),c=r.length,u=Array(c),p={},d=c;if(e=e.filter((function(t,i){t=t.user.user_id+"@"+t.user.user_source;var n=a.indexOf(t);return!(-1<n)||(d--,u[n]=e[i],p[t]=!0,t===s.user_id+"@"+s.user_source&&(u[n].contact={avatar:s.avatar,user_name:"通知"},u[n].is_top_group=!0,u[n].unread_show_type="rash"),!1)})),0===d)u=u.filter((function(e){return e})),t(u.concat(e));else{var l=function(e,t){return t.sort_time-e.sort_time},f=function(){d--,0===d&&(u=u.sort(l),u=u.filter((function(e){return e})),t(u.concat(e)))};r.forEach((function(e,t){var n=e.user_id,r=e.user_source;if(!p[n+"@"+r]){var s={msg:null,user:e,sort_time:(new Date).getTime(),is_top_group:!0};n+"@"+r===ICS_INFO.user_id+"@"+ICS_INFO.user_source&&(s.contact={avatar:ICS_INFO.avatar}),e={count:1,option:-1,user_id:n,user_source:r},e.user_id==o.user_id&&e.user_source==o.user_source?(s.msg={msg_id:null,content:{msg:"Hi~我是您的智能客服",type:"text"},send_time:(new Date).getTime(),msg_type:"text"},s.sort_time=s.msg.send_time,s.is_top_group=!0,u[t]=s,f()):i.getMsgRecords(e,(function(e){0<e.length?(e=e[0],"string"===typeof e.content&&(e.content=JSON.parse(e.content)),s.msg={msg_id:e.msg_id,content:e.content,send_time:e.send_time,msg_type:e.msg_type},s.sort_time=s.msg.send_time,u[t]=s):u.splice(t,1),f()}),(function(e){f()}))}}))}},"on-session-item-click":function(t){var i=!0;return t.user_id+"@"+t.user_source===ICS_INFO.user_id+"@"+ICS_INFO.user_source&&(e.parent.open(ICS_INFO.getUrl(),"_blank"),i=!1),i}}}),e.webimapp.addEventListener("chatwindowCreated",(function(t,i){-1!==[ZNX_INFO.user_id+"@"+ZNX_INFO.user_source].indexOf(t+"@"+i)&&e.webimapp.disableInput(t,i,!0)})),function(e){try{e.RTCEmitter&&e.RTCEmitter.emit("loadWebRTC",{env:ENVS,clientType:"pcweb",cometCommonParams:e.webimbiz.cometCommonParams,isWebimoutside:!1}),e.RTCEmitter&&e.RTCEmitter.on("callToCallee",(function(e){i.call(e.data,e.callback)})),e.RTCEmitter&&e.RTCEmitter.on("update_call",(function(e){i.update_call(e.data,e.callback)})),e.RTCEmitter&&e.RTCEmitter.on("titleNotify",(function(e){e.msg?(webimapp.titleNotify(null,"【您有一条音视频请求】"),webimapp.normalize()):webimapp.titleNotify()})),e.webimbiz.addEventListener("callMsgReceived",(function(t){t=t[0].msg_list;var i=t[t.length-1],n={user_id:i.sender_id,user_source:i.sender_source};t=e.webimbiz.cometCommonParams,t=t.user_id+"@"+t.source;var o=i.kf_id+"@"+i.kf_source,r=!1;(function(e){return!("null"===e+""||"undefined"===e+""||""===e)&&"9999"==Number(e)})(i.to_source)&&t==o&&(n.shop_id=i.to_id,n.shop_source=i.to_source,r=!0),e.webimbiz.getContact([n],(function(t){t=t[r?n.user_id+"@"+n.user_source+"@@"+n.shop_id+"@"+n.shop_source:n.user_id+"@"+n.user_source],r&&(t.shop_id=n.shop_id,t.shop_source=n.shop_source),t.name=t.remark?t.remark.remark_name||t.user_name||t.name||"未知":t.user_name||t.name||"未知",t.avatar=t&&t.avatar?t.avatar:default_avatar,e.RTCEmitter&&e.RTCEmitter.emit("calleeLoadWebRTC",{msgItem:i,contact:t})}))}))}catch(t){}}(e),"rb"==l("p")?e.webimapp.position("RIGHT_BOTTOM"):e.webimapp.position("CENTER"),e.parent!=e.self&&e.parent.WebIM.onAppCreated(webimapp)}})(),function(){var t=s();setInterval((function(){s()!=t&&(e.location.href=e.location.href)}),1e3)}()};e.WMDA_SDK_CONFIG={api_v:1,sdk_v:.1,mode:"report",appid:0xa3430fba636,key:"n8lxghfg",project_id:"11187958619315",cookie_domain:document.domain,SPA_HASH:!0},e.parent!=e.self&&e.parent.WebIM.onAppBegin(),e.onload=function(){t("<script>").attr("src","//j1.58cdn.com.cn/wmda/js/statistic.js?"+ +new Date).appendTo(t("body")),a((function(t,i){e.USER_ID=t,e.IM_TOKEN=i,f()}),(function(){if(e.parent==e.self)return e.location.href=LOGIN_URL+encodeURIComponent(e.location.href);f()}));var i={clientType:"1",jqtype:12,from:"wuba_im"};e.__tracker&&e.__tracker.init(i)}}(window);